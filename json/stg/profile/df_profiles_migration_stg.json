{
    "name": "df_profiles_migration_stg",
    "properties": {
        "folder": {
            "name": "ccore/TDATA-4433/stg"
        },
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profile_stg",
                        "type": "DatasetReference"
                    },
                    "name": "NaProfile"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_ca_profile_stg",
                        "type": "DatasetReference"
                    },
                    "name": "CaProfile"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profiles_eliminated_stg",
                        "type": "DatasetReference"
                    },
                    "name": "naEliminatedProfiles"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_ca_profiles_eliminated_stg",
                        "type": "DatasetReference"
                    },
                    "name": "caEliminatedProfiles"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profiles_stg",
                        "type": "DatasetReference"
                    },
                    "name": "SinkGlobalProfile"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profiles_retained_stg",
                        "type": "DatasetReference"
                    },
                    "name": "SinkNaProfileRetained"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_ca_profiles_retained_stg",
                        "type": "DatasetReference"
                    },
                    "name": "SinkCaProfileRetained"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profiles_stg",
                        "type": "DatasetReference"
                    },
                    "name": "sinkCommonProfiles"
                },
                {
                    "dataset": {
                        "referenceName": "ds_cntnr_na_profiles_common_stg",
                        "type": "DatasetReference"
                    },
                    "name": "sinkAtCommonProfilesContainer"
                }
            ],
            "transformations": [
                {
                    "name": "NaUnionCaRetainedProfiles"
                },
                {
                    "name": "SelectPrefLangAndVipinfoFromCa"
                },
                {
                    "name": "SelectCaRetainedProfiles"
                },
                {
                    "name": "NaRetainedProfiles"
                },
                {
                    "name": "CaRetainedProfiles"
                },
                {
                    "name": "CaRetainedProfilesDoesNotExistsInNaRetainedProfiles"
                },
                {
                    "name": "derivedNaRegionAndCountry"
                },
                {
                    "name": "derivedCaRegionAndCountry"
                },
                {
                    "name": "NaJoinCaRetainedProfiles"
                },
                {
                    "name": "derivePrefLangAndVipInfoNew"
                },
                {
                    "name": "removeCaCols"
                },
                {
                    "name": "NaRetainedProfilesDoesNotExistInCaRetainedProfiles"
                },
                {
                    "name": "selectColsForCommonProfileContainer"
                },
                {
                    "name": "removeCaPreferredStores"
                }
            ],
            "scriptLines": [
                "source(output(",
                "          bannerOfOrigin as string,",
                "          birthday as string,",
                "          changedBy as string,",
                "          changedFields as string,",
                "          country as string,",
                "          created as long,",
                "          createdBy as string,",
                "          csaInfo as (csaAgentEmail as string, zendeskTicketNumber as string),",
                "          customerFlag as string,",
                "          customerId as string,",
                "          customerSyncStatus as (status as string, updateTs as long, process as string),",
                "          email as string,",
                "          emailHistory as (emailAddress as string, modificationTS as string)[],",
                "          emailVerified as long,",
                "          event as string,",
                "          failedLoginAttempts as long,",
                "          firstName as string,",
                "          flxInfo as (flxEmailOptIn as boolean, loyaltyFlxEmailOptInBanner as string, loyaltyStatus as boolean, points as integer, tier as string, flxNumber as long, ctNumber as integer, flxTcVersion as string, referralCode as string),",
                "          fraudFlag as string[],",
                "          gender as string,",
                "          homeNumber as long,",
                "          inStoreSignUp as boolean,",
                "          isRegistered as boolean,",
                "          janrainUuid as string,",
                "          lastFailedLogin as string,",
                "          lastLogin as string,",
                "          lastName as string,",
                "          militaryExpiryDate as string,",
                "          militaryRequestId as string,",
                "          militaryStatus as string,",
                "          mobileNumber as long,",
                "          oldCsCid as string,",
                "          oldEbCid as string,",
                "          oldFaCid as string,",
                "          oldFlCid as string,",
                "          oldFlcaCid as string,",
                "          oldFsCid as string,",
                "          oldKflCid as string,",
                "          oldLflCid as string,",
                "          optIns as (banner as string)[],",
                "          password as string,",
                "          passwordChangeDate as string,",
                "          preferredLanguage as string,",
                "          preferredStores as (CS as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), FA as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), FL as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), KFL as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string)),",
                "          previousEmail as string,",
                "          profileStatus as string,",
                "          region as string,",
                "          relateCustomerId as string,",
                "          relateFailure as boolean,",
                "          retailStoreId as integer,",
                "          schDefaultBillingAddressLine1 as string,",
                "          schDefaultShippingAddressLine1 as string,",
                "          storeNumber as string,",
                "          streetAddress as string,",
                "          token as string,",
                "          updateTs as long,",
                "          updateTsExceptLogin as long,",
                "          vipInfo as (dollarsNeedToSpend as (currencyIso as string, formattedValue as string, value as integer), loyaltyMinThreshold as (currencyIso as string, formattedValue as string, value as integer), dollarsSpent as (currencyIso as string, formattedValue as string, value as integer), loyaltyTargetThreshold as (currencyIso as string, formattedValue as string, value as integer), vipNumber as string, lastLevelUpdateDateHyb as long, lastLevelMoveDate as long, loyaltyExpireDate as long, isVip as boolean, lifeTimePoints as long, status as string),",
                "          webhookMessageStatus as string,",
                "          xstoreId as string,",
                "          zipCode as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'document',",
                "     systemColumns: true) ~> NaProfile",
                "source(output(",
                "          bannerOfOrigin as string,",
                "          birthday as string,",
                "          changedBy as string,",
                "          changedFields as string,",
                "          country as string,",
                "          created as long,",
                "          createdBy as string,",
                "          csaInfo as (csaAgentEmail as string, zendeskTicketNumber as string),",
                "          customerFlag as string,",
                "          customerId as string,",
                "          customerSyncStatus as (status as string, updateTs as long, process as string),",
                "          email as string,",
                "          emailHistory as (emailAddress as string, modificationTS as string)[],",
                "          emailVerified as long,",
                "          event as string,",
                "          failedLoginAttempts as long,",
                "          firstName as string,",
                "          flxInfo as (flxEmailOptIn as boolean, loyaltyFlxEmailOptInBanner as string, loyaltyStatus as boolean, points as integer, tier as string, flxNumber as long, ctNumber as integer, flxTcVersion as string, referralCode as string),",
                "          fraudFlag as string[],",
                "          gender as string,",
                "          homeNumber as long,",
                "          inStoreSignUp as boolean,",
                "          isRegistered as boolean,",
                "          janrainUuid as string,",
                "          lastFailedLogin as string,",
                "          lastLogin as string,",
                "          lastName as string,",
                "          militaryExpiryDate as string,",
                "          militaryRequestId as string,",
                "          militaryStatus as string,",
                "          mobileNumber as long,",
                "          oldCsCid as string,",
                "          oldEbCid as string,",
                "          oldFaCid as string,",
                "          oldFlCid as string,",
                "          oldFlcaCid as string,",
                "          oldFsCid as string,",
                "          oldKflCid as string,",
                "          oldLflCid as string,",
                "          optIns as (banner as string)[],",
                "          password as string,",
                "          passwordChangeDate as string,",
                "          preferredLanguage as string,",
                "          preferredStores as (CS as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), FA as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), FL as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string), KFL as (city as string, country as string, division as string, isocodeShort as string, latitude as double, line1 as string, line2 as string, longitude as double, name as string, phone as string, state as string, status as string, storeId as string, zipcode as string)),",
                "          previousEmail as string,",
                "          profileStatus as string,",
                "          region as string,",
                "          relateCustomerId as string,",
                "          relateFailure as boolean,",
                "          retailStoreId as integer,",
                "          schDefaultBillingAddressLine1 as string,",
                "          schDefaultShippingAddressLine1 as string,",
                "          storeNumber as string,",
                "          streetAddress as string,",
                "          token as string,",
                "          updateTs as long,",
                "          updateTsExceptLogin as long,",
                "          vipInfo as (dollarsNeedToSpend as (currencyIso as string, formattedValue as string, value as integer), loyaltyMinThreshold as (currencyIso as string, formattedValue as string, value as integer), dollarsSpent as (currencyIso as string, formattedValue as string, value as integer), loyaltyTargetThreshold as (currencyIso as string, formattedValue as string, value as integer), vipNumber as string, lastLevelUpdateDateHyb as long, lastLevelMoveDate as long, loyaltyExpireDate as long, isVip as boolean, lifeTimePoints as long, status as string),",
                "          webhookMessageStatus as string,",
                "          xstoreId as string,",
                "          zipCode as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'document',",
                "     systemColumns: true) ~> CaProfile",
                "source(output(",
                "          eliminationReason as string,",
                "          customerId as string,",
                "          emailVerified as integer,",
                "          janrainUuid as string,",
                "          created as integer,",
                "          isRegistered as boolean,",
                "          email as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'document',",
                "     systemColumns: true) ~> naEliminatedProfiles",
                "source(output(",
                "          eliminationReason as string,",
                "          emailVerified as integer,",
                "          janrainUuid as string,",
                "          created as integer,",
                "          customerId as string,",
                "          isRegistered as boolean,",
                "          email as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'document',",
                "     systemColumns: true) ~> caEliminatedProfiles",
                "NaRetainedProfilesDoesNotExistInCaRetainedProfiles, removeCaPreferredStores union(byName: true)~> NaUnionCaRetainedProfiles",
                "SelectCaRetainedProfiles select(mapColumn(",
                "          email,",
                "          preferredLanguage,",
                "          vipInfo,",
                "          janrainUuid,",
                "          customerId",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> SelectPrefLangAndVipinfoFromCa",
                "CaRetainedProfiles select(mapColumn(",
                "          bannerOfOrigin,",
                "          birthday,",
                "          changedBy,",
                "          changedFields,",
                "          country,",
                "          createdBy,",
                "          csaInfo,",
                "          customerFlag,",
                "          customerId,",
                "          customerSyncStatus,",
                "          email,",
                "          emailHistory,",
                "          emailVerified,",
                "          event,",
                "          failedLoginAttempts,",
                "          firstName,",
                "          flxInfo,",
                "          fraudFlag,",
                "          gender,",
                "          homeNumber,",
                "          inStoreSignUp,",
                "          isRegistered,",
                "          janrainUuid,",
                "          lastFailedLogin,",
                "          lastLogin,",
                "          lastName,",
                "          militaryExpiryDate,",
                "          militaryRequestId,",
                "          militaryStatus,",
                "          mobileNumber,",
                "          oldCsCid,",
                "          oldEbCid,",
                "          oldFaCid,",
                "          oldFlCid,",
                "          oldFlcaCid,",
                "          oldFsCid,",
                "          oldKflCid,",
                "          oldLflCid,",
                "          optIns,",
                "          password,",
                "          passwordChangeDate,",
                "          preferredLanguage,",
                "          previousEmail,",
                "          profileStatus,",
                "          region,",
                "          relateCustomerId,",
                "          relateFailure,",
                "          retailStoreId,",
                "          schDefaultBillingAddressLine1,",
                "          schDefaultShippingAddressLine1,",
                "          storeNumber,",
                "          streetAddress,",
                "          token,",
                "          updateTs,",
                "          updateTsExceptLogin,",
                "          vipInfo,",
                "          webhookMessageStatus,",
                "          xstoreId,",
                "          zipCode,",
                "          id,",
                "          created",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> SelectCaRetainedProfiles",
                "derivedNaRegionAndCountry, naEliminatedProfiles exists(NaProfile@id == naEliminatedProfiles@id,",
                "     negate:true,",
                "     broadcast: 'auto')~> NaRetainedProfiles",
                "derivedCaRegionAndCountry, caEliminatedProfiles exists(CaProfile@id == caEliminatedProfiles@id,",
                "     negate:true,",
                "     broadcast: 'auto')~> CaRetainedProfiles",
                "CaRetainedProfiles, NaRetainedProfiles exists(CaProfile@email == NaProfile@email,",
                "     negate:true,",
                "     broadcast: 'auto')~> CaRetainedProfilesDoesNotExistsInNaRetainedProfiles",
                "NaProfile derive(region = iif(or(isNull(region),equalsIgnoreCase(region, '')), \"US\", region),",
                "          country = iif(or(isNull(country),equalsIgnoreCase(country, '')), \"US\", country),",
                "          created = toString(toTimestamp(toLong(toString(created)))),",
                "          updateTs = toString(toTimestamp(toLong(toString(updateTs)))),",
                "          emailVerified = toString(toTimestamp(toLong(toString(emailVerified)))),",
                "          updateTsExceptLogin = toString(toTimestamp(toLong(toString(updateTsExceptLogin))))) ~> derivedNaRegionAndCountry",
                "CaProfile derive(region = iif(or(isNull(region),equalsIgnoreCase(region, '')), \"CA\", region),",
                "          country = iif(or(isNull(country),equalsIgnoreCase(country, '')), \"CA\", country),",
                "          created = toString(toTimestamp(toLong(toString(created)))),",
                "          updateTs = toString(toTimestamp(toLong(toString(updateTs)))),",
                "          emailVerified = toString(toTimestamp(toLong(toString(emailVerified)))),",
                "          updateTsExceptLogin = toString(toTimestamp(toLong(toString(updateTsExceptLogin))))) ~> derivedCaRegionAndCountry",
                "NaRetainedProfiles, SelectPrefLangAndVipinfoFromCa join(NaProfile@email == SelectPrefLangAndVipinfoFromCa@email,",
                "     joinType:'inner',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> NaJoinCaRetainedProfiles",
                "NaJoinCaRetainedProfiles derive(preferredLanguage = iif(equalsIgnoreCase(SelectPrefLangAndVipinfoFromCa@preferredLanguage, 'fr'), 'fr', 'en'),",
                "          vipInfo = iif(isNull(SelectPrefLangAndVipinfoFromCa@vipInfo), NaProfile@vipInfo, SelectPrefLangAndVipinfoFromCa@vipInfo)) ~> derivePrefLangAndVipInfoNew",
                "derivePrefLangAndVipInfoNew select(mapColumn(",
                "          bannerOfOrigin,",
                "          birthday,",
                "          changedBy,",
                "          changedFields,",
                "          country,",
                "          createdBy,",
                "          csaInfo,",
                "          customerFlag,",
                "          customerId = NaProfile@customerId,",
                "          customerSyncStatus,",
                "          email = NaProfile@email,",
                "          emailHistory,",
                "          event,",
                "          failedLoginAttempts,",
                "          firstName,",
                "          flxInfo,",
                "          fraudFlag,",
                "          gender,",
                "          homeNumber,",
                "          inStoreSignUp,",
                "          isRegistered,",
                "          janrainUuid,",
                "          lastFailedLogin,",
                "          lastLogin,",
                "          lastName,",
                "          militaryExpiryDate,",
                "          militaryRequestId,",
                "          militaryStatus,",
                "          mobileNumber,",
                "          oldCsCid,",
                "          oldEbCid,",
                "          oldFaCid,",
                "          oldFlCid,",
                "          oldFlcaCid,",
                "          oldFsCid,",
                "          oldKflCid,",
                "          oldLflCid,",
                "          optIns,",
                "          password,",
                "          passwordChangeDate,",
                "          preferredLanguage,",
                "          preferredStores,",
                "          previousEmail,",
                "          profileStatus,",
                "          region,",
                "          relateCustomerId,",
                "          relateFailure,",
                "          retailStoreId,",
                "          schDefaultBillingAddressLine1,",
                "          schDefaultShippingAddressLine1,",
                "          storeNumber,",
                "          streetAddress,",
                "          token,",
                "          vipInfo,",
                "          webhookMessageStatus,",
                "          xstoreId,",
                "          zipCode,",
                "          id,",
                "          created,",
                "          emailVerified,",
                "          updateTs,",
                "          updateTsExceptLogin",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> removeCaCols",
                "NaRetainedProfiles, CaRetainedProfiles exists(NaProfile@email == CaProfile@email,",
                "     negate:true,",
                "     broadcast: 'auto')~> NaRetainedProfilesDoesNotExistInCaRetainedProfiles",
                "NaJoinCaRetainedProfiles select(mapColumn(",
                "          email = NaProfile@email,",
                "          naCustomerId = NaProfile@customerId,",
                "          naJanrainUuid = NaProfile@janrainUuid,",
                "          caCustomerId = SelectPrefLangAndVipinfoFromCa@customerId,",
                "          caJanrainUuid = SelectPrefLangAndVipinfoFromCa@janrainUuid",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> selectColsForCommonProfileContainer",
                "CaRetainedProfilesDoesNotExistsInNaRetainedProfiles select(mapColumn(",
                "          bannerOfOrigin,",
                "          birthday,",
                "          changedBy,",
                "          changedFields,",
                "          country,",
                "          created,",
                "          createdBy,",
                "          csaInfo,",
                "          customerFlag,",
                "          customerId,",
                "          customerSyncStatus,",
                "          email,",
                "          emailHistory,",
                "          emailVerified,",
                "          event,",
                "          failedLoginAttempts,",
                "          firstName,",
                "          flxInfo,",
                "          fraudFlag,",
                "          gender,",
                "          homeNumber,",
                "          inStoreSignUp,",
                "          isRegistered,",
                "          janrainUuid,",
                "          lastFailedLogin,",
                "          lastLogin,",
                "          lastName,",
                "          militaryExpiryDate,",
                "          militaryRequestId,",
                "          militaryStatus,",
                "          mobileNumber,",
                "          oldCsCid,",
                "          oldEbCid,",
                "          oldFaCid,",
                "          oldFlCid,",
                "          oldFlcaCid,",
                "          oldFsCid,",
                "          oldKflCid,",
                "          oldLflCid,",
                "          optIns,",
                "          password,",
                "          passwordChangeDate,",
                "          preferredLanguage,",
                "          previousEmail,",
                "          profileStatus,",
                "          region,",
                "          relateCustomerId,",
                "          relateFailure,",
                "          retailStoreId,",
                "          schDefaultBillingAddressLine1,",
                "          schDefaultShippingAddressLine1,",
                "          storeNumber,",
                "          streetAddress,",
                "          token,",
                "          updateTs,",
                "          updateTsExceptLogin,",
                "          vipInfo,",
                "          webhookMessageStatus,",
                "          xstoreId,",
                "          zipCode,",
                "          id",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> removeCaPreferredStores",
                "NaUnionCaRetainedProfiles sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     recreate:true,",
                "     format: 'document',",
                "     batchSize: 25000,",
                "     partitionKey: ['/id'],",
                "     throughput: 50000,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     saveOrder: 1) ~> SinkGlobalProfile",
                "NaRetainedProfiles sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     recreate:true,",
                "     format: 'document',",
                "     batchSize: 25000,",
                "     partitionKey: ['/id'],",
                "     throughput: 50000,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     saveOrder: 1) ~> SinkNaProfileRetained",
                "CaRetainedProfilesDoesNotExistsInNaRetainedProfiles sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     recreate:true,",
                "     format: 'document',",
                "     batchSize: 25000,",
                "     partitionKey: ['/id'],",
                "     throughput: 50000,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     saveOrder: 1) ~> SinkCaProfileRetained",
                "removeCaCols sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     recreate:false,",
                "     format: 'document',",
                "     batchSize: 25000,",
                "     partitionKey: ['/id'],",
                "     throughput: 50000,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     saveOrder: 2) ~> sinkCommonProfiles",
                "selectColsForCommonProfileContainer sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     input(",
                "          lastName as string,",
                "          flxInfo as (flxEmailOptIn as boolean, loyaltyStatus as boolean, flxTcVersion as integer, tier as string, flxNumber as integer, ctNumber as integer, points as integer, loyaltyFlxEmailOptInBanner as string),",
                "          created as integer,",
                "          changedFields as string,",
                "          emailHistory as string[],",
                "          emailVerified as integer,",
                "          firstName as string,",
                "          optIns as string[],",
                "          militaryStatus as boolean,",
                "          createdBy as string,",
                "          inStoreSignUp as boolean,",
                "          janrainUuid as string,",
                "          changedBy as string,",
                "          customerId as string,",
                "          shippingAddress as ({} as string),",
                "          isRegistered as boolean,",
                "          billingAddress as ({} as string),",
                "          event as string,",
                "          updateTs as integer,",
                "          email as string,",
                "          profileStatus as string,",
                "          zipCode as string,",
                "          mobileNumber as integer,",
                "          schDefaultShippingAddressLine1 as string,",
                "          schDefaultBillingAddressLine1 as string,",
                "          updateTsExceptLogin as string",
                "     ),",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     recreate:true,",
                "     format: 'document',",
                "     batchSize: 25000,",
                "     partitionKey: ['/id'],",
                "     throughput: 50000,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     saveOrder: 1) ~> sinkAtCommonProfilesContainer"
            ]
        }
    }
}